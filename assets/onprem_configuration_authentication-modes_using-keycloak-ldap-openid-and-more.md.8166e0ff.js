import{_ as a,c as e,o,a as n}from"./app.ad4e2cff.js";const g=JSON.parse('{"title":"Using Keycloak (LDAP, OpenID and more)","description":"Use Keycloak with Twake","frontmatter":{"description":"Use Keycloak with Twake"},"headers":[],"relativePath":"onprem/configuration/authentication-modes/using-keycloak-ldap-openid-and-more.md"}'),t={name:"onprem/configuration/authentication-modes/using-keycloak-ldap-openid-and-more.md"},s=n(`<h1 id="using-keycloak-ldap-openid-and-more" tabindex="-1">Using Keycloak (LDAP, OpenID and more) <a class="header-anchor" href="#using-keycloak-ldap-openid-and-more" aria-hidden="true">#</a></h1><h4 id="run-keycloak-and-persist-data" tabindex="-1">Run keycloak and persist data <a class="header-anchor" href="#run-keycloak-and-persist-data" aria-hidden="true">#</a></h4><div class="language-text"><button class="copy"></button><span class="lang">text</span><pre><code><span class="line"><span style="color:#A6ACCD;">cd twake</span></span>
<span class="line"><span style="color:#A6ACCD;">docker run -p 8080:8080 -e KEYCLOAK_USER=admin -e KEYCLOAK_PASSWORD=admin -v $(pwd)/docker-data/keycloak-db:/opt/jboss/keycloak/standalone/data jboss/keycloak</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h4 id="configure-keycloak-with-twake-for-the-first-time" tabindex="-1">Configure keycloak with twake for the first time <a class="header-anchor" href="#configure-keycloak-with-twake-for-the-first-time" aria-hidden="true">#</a></h4><p><strong>On Keycloak</strong></p><p>Go to <code>http://localhost:8080/auth/</code></p><p>Login with admin:admin</p><p>Go to client &gt; account &gt; Credentials tab and save the <code>Secret</code></p><p>Go to Settings tab and add a Valid Redirect uri to <code>http://localhost:8000/*</code> and save</p><p>Then create an user in User / Add User</p><p>\u26A0\uFE0F Users must have an email and the email must be marked as verified !</p><p>Then create a password for this user.</p><p><strong>On Twake</strong></p><p>Go to your [docker-compose file location]/configuration/backend/Parameters.php (see <a href="./../">Configuration</a>)</p><p>Change defaults.auth.openid to:</p><div class="language-text"><button class="copy"></button><span class="lang">text</span><pre><code><span class="line"><span style="color:#A6ACCD;">  &quot;use&quot; =&gt; true,</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;provider_uri&quot; =&gt; &#39;http://[machine_ip]:8080/auth/realms/master&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;client_id&quot; =&gt; &#39;account&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;client_secret&quot; =&gt; &#39;[keycloak_secret]&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;logout_suffix&quot; =&gt; &quot;/protocol/openid-connect/logout&quot; //Specific to keycloak</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u2139\uFE0F [machine_ip] Because Twake is accessing keycloak for inside a docker container, do not use localhost or 127.0.0.1 to access keycloak.</p>`,17),c=[s];function i(p,r,l,d,u,k){return o(),e("div",null,c)}const m=a(t,[["render",i]]);export{g as __pageData,m as default};
